# [2026-01-14] 트러블슈팅: 코드 변경 사항 미반영 원인 분석

## 1. 문제 상황 (Symptoms)
- **요청 사항**: "빈 타일 비율 50%로 변경", "Start/End 고정", "다중 전구 및 회로 피드백 추가".
- **발생 현상**: 에이전트(AI)가 코드를 수정했다고 답변했으나, 실제 브라우저에서 실행해 보면 이전 로직(빈 타일 30%, 단일 전구 등)이 그대로 유지되거나 일부만 적용되어 코드가 꼬이는 현상 발생.

## 2. 원인 분석 (Root Cause Analysis)

### A. 부분 수정 도구(diff-based edit)의 한계
AI는 `replace_file_content`라는 도구를 사용하여 파일의 특정 부분만 찾아 바꿉니다. 이 도구는 **"바꿀 대상의 정확한 문자열(Target Content)"**을 찾아야 작동합니다.

1.  **중복 패턴 문제**: `Grid` 클래스나 `Pipe` 생성 로직 등은 구조가 매우 유사합니다. AI가 수정을 시도할 때, 교체하려는 코드가 파일 내에 여러 군데 비슷하게 존재하면 도구가 위치를 특정하지 못해 수정을 누락하는 경우가 발생했습니다.
2.  **컨텍스트 불일치 (Context Mismatch)**: 이전에 수정한 내용이 미세하게 공백이나 줄바꿈을 변경했는데, AI가 구버전 코드를 기준으로 수정을 시도하면 일치하는 대상을 찾지 못해 에러가 발생합니다.

### B. 에러 간과 및 검증 부족
도구 사용 시 "Target content not found(수정 실패)" 에러가 발생했음에도, AI가 이를 성공으로 착각하거나 실패 후 재시도 과정에서 코드를 안전하게 덮어쓰지 못했습니다.

## 3. 해결 조치 (Corrective Action)

### 전체 파일 덮어쓰기 (Full Overwrite) 수행
부분 수정의 불확실성을 제거하기 위해, 핵심 로직이 포함된 **전체 `puzzle_mvp.html` 파일을 새로 작성(Rewrite)**하여 덮어썼습니다. 이를 통해 기존의 꼬인 코드를 100% 정리하고 최신 기능을 정상 반영했습니다.

## 4. 향후 예방 (Prevention)
- **블록 단위 재작성**: 로직이 복잡한 파일은 부분 수정 대신 함수나 클래스 전체를 다시 작성하는 방식을 우선합니다.
- **명시적 검증**: 수정 후 `view_file`을 통해 실제 파일에 코드가 반영되었는지 직접 확인하는 단계를 추가합니다.

---
**작성일**: 2026년 1월 14일
**작성자**: Antigravity Agent
