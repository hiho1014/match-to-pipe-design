# 작업 일지 (Work Log)
 
## [2026-01-15] 인더스트리얼 디테일 고도화 및 숨겨진 요소 (Hidden Secret) 구현
 
### 1. 주요 작업 개요
- **목표**: 단순 비주얼을 넘어선 하이엔드 인더스트리얼 디테일링 및 게임적 재미를 위한 '비밀 암호' 기믹 추가.
- **핵심 키워드**: 중공업 디테일(Heavy Detail), 스포트라이트(Spotlight), 실루엣(Silhouette), 커스텀 커서.
 
### 2. 상세 작업 내역
 
#### 1) 변압기 및 전구 컴포넌트 고도화 (Premium Industrial Components)
- **변압기 (Hazard Yellow Transformer)**: 
    - 단순 박스에서 냉각핀(Cooling Fins), 고전압 경고판(Warning Plate), 상단 고리(Lugs) 등이 포함된 정교한 기계 장치로 재설계.
    - 파이프 시스템과의 자연스러운 연결을 위해 하단에 전용 플랜지 커넥터 배치 및 위치 최적화.
- **인더스트리얼 벌브 (Caged Bulb)**: 
    - 묵직한 강철 베이스와 강화 유리 돔, 그리고 이를 보호하는 철제 케이지(Cage) 일러스트레이션 구현.
    - 단순 점등 방식에서 '실제 기기'가 작동하는 듯한 조명 연출로 업그레이드.
 
#### 2) 숨겨진 암호 기믹 (Hidden Silhouette/Secret Character)
- **암호 노출 로직**: 전구 내부에 배경색과 동일한 검은색 글자('R', 'E')를 배치하여 평소에는 완벽하게 은폐.
- **실루엣 연출**: 전원이 연결되어 스포트라이트가 켜지면, 밝은 광선을 배경으로 글자가 **검은 실루엣**으로 뚜렷하게 드러나도록 구현.
- **시각적 완성도**: 글자가 빛 속에 투사되는 느낌을 위해 미세한 블러(Blur) 처리와 크기 조정 적용.
 
#### 3) 스포트라이트 빔 연출 (Conical Spotlight Beam)
- **광선 시스템**: 단순 원형 글로우를 폐기하고, 아래 방향으로 퍼지는 **원뿔형 스포트라이트 광선**으로 교체.
- **프리미엄 블룸(Bloom)**: `PIXI.filters.BlurFilter`를 적용하여 조명 가장자리가 부드럽게 산란되는 현실적인 빛 연출 확보.
 
#### 4) 커스텀 렌치 커서(Wrench Cursor) 도입
- **도구 아이콘**: 인더스트리얼 분위기에 맞는 렌치 모양의 커스텀 SVG 커서 제작 및 적용.
- **PixiJS 동기화**: 일반 CSS 커서가 엔진 내부에서 작동하지 않는 문제를 해결하기 위해 PixiJS `cursorStyles`에 렌치 스타일을 정식 등록하여 파이프 위에서도 완벽하게 작동하도록 보정.
 
#### 5) 파이프 에너지 시각화 정밀 정제 (Visual Polish)
- **부풀어 오름 현상 해결**: 파이프보다 두꺼웠던 광선 두께를 조정하고 블러 필터를 적용하여, 파이프의 외형은 유지하면서 주변으로 빛만 번지는 세련된 느낌 구현.
- **에너지 코어 선명화**: 파이프 내부 코어 라인을 더 얇고 날카롭게 다듬고 하얀 하이라이트를 추가하여 고전압 에너지의 흐름 표현.
 
### 3. 트러블슈팅 및 해결 과정
- **문제**: 전구에 불이 들어와도 글자가 묻히거나 입체감이 부족함.
- **해결**: 글자 레이어를 최상단으로 옮기고, 빛의 투과가 아닌 '역광 실루엣' 방식으로 연출을 변경하여 가독성과 극적인 효과를 동시에 확보.
- **문제**: 엔진(PixiJS) 내부 객체 위에서 커스텀 커서가 풀리는 현상.
- **해결**: `app.renderer.events.cursorStyles` API를 활용하여 엔진 레벨에서 커스텀 커서를 관리하도록 수정.
 
---


## [2026-01-15] 디자인 롤백 (Design Revert)
- **조치**: "일러스트레이션" 및 "리얼리스틱" 시도 버전을 모두 폐기하고, 사용자가 만족했던 **"Heavy Industrial (v2.4)"** 버전으로 원복.
- **포함 사항**: 
    -   노란색 변압기 (Hazard Yellow Core)
    -   클릭 개선 패치 (HitArea & Layer fix)
    -   마커 레이어 순서 조정

---

## [2026-01-15] Realistic Industrial Design 전면 개편

### 1. 주요 작업 개요
- **목표**: 사용자 피드백에 따라 "일러스트레이션" 스타일을 폐기하고, **"실제 산업용 파이프(Real Industrial Pipe)"**의 질감과 분위기를 구현.
- **핵심 키워드**: 사실성(Realism), 중금속(Heavy Metal), 물리적 조명(Physical Lighting).

### 2. 상세 작업 내역

#### 1) 텍스처 및 재질 시스템 도입
- **절차적 노이즈(Procedural Noise)**: `createNoiseTexture` 함수를 구현하여 외부 에셋 없이도 금속의 거친 표면, 녹(Rust), 기름때를 픽셀 단위로 생성.
- **재질 표현**:
    -   `METAL_BASE` (2b2b2b): 기본 주철 색상.
    -   `RUST` (4a3c31): 부식된 디테일 추가.
    -   `METAL_SHADOW` (111111): 깊은 앰비언트 오클루전 그림자.

#### 2) 입체적 파이프 렌더링 (3D Volumetric Pipe)
- **방향성 조명(Directional Lighting)**: 상단에서 빛이 내려오는 것을 가정하여, 수직/수평 파이프의 하이라이트와 쉐도우 위치를 다르게 계산하여 원통형 입체감 구현.
- **플랜지 및 볼트**: 기존의 단순한 사각형이 아닌, 파이프 끝단에 체결되는 두꺼운 철판(Flange)과 육각 볼트 디테일 추가.

#### 3) 인더스트리얼 컴포넌트 디자인
- **발전기 유닛(Generator)**: 
    -   "Hazard Yellow" 컬러에 마모된(Weathered) 질감을 입히고, 검은색 안전 스트라이프를 더티하게 처리.
    -   바닥에 고정된 무거운 베이스 플레이트 구현.
- **밸브 핸들**: 입체적인 쉐이딩을 적용하여 손으로 잡고 돌릴 수 있을 듯한 물리적 형태감 강조.

#### 4) 조명 및 분위기
- **인디케이터 시스템**: 파이프 전체가 밝게 빛나는 비현실적 연출 대신, 파이프 표면에 작은 **유리 슬릿(Indicator Slit)**을 뚫어 그 사이로 에너지가 보이는 절제된 연출 적용.
- **배경**: 콘크리트 타일 바닥과 이음매(Seam) 표현으로 지하 시설 분위기 조성.

---

## [2026-01-15] Heavy Industrial Pipe 디자인 전면 개편

### 1. 주요 작업 개요
- **목표**: 도면 스타일을 넘어선 실제 '중공업 현장' 느낌의 묵직하고 현실적인 비주얼 구현.
- **핵심 컨셉**: 어두운 철재 전선관(Iron Conduit), 녹슨 질감(Rust), 오렌지색 밸브 핸들, 네온 에너지 시각화.

### 2. 상세 작업 내역

#### 1) 묵직한 철재 파이프 비주얼 (Heavy Metal Aesthetics)
- **질감 표현**: `0x3a3a3a` (Iron) 색상을 베이스로 입체적인 쉐도우와 하이라이트를 수동 드로잉하여 묵직한 금속관 느낌 구현.
- **연결 플랜지 고도화**: 파이프 끝단에 두툼한 원형/각형 플랜지를 추가하여 물리적인 연결감 강화.
- **밸브 핸들 도입**: 클릭 가능한 타일 중앙에 오렌지색(`0xcc7722`) 밸브 핸들을 배치하여 상호작용의 직관성 부여.

#### 2) 네온 에너지 코어 시각화 (Neon Core Flow)
- **에너지 흐름**: 파이프 중앙에 얇고 강렬한 네온 라인(`0x00ffff`, `0xff00ff`)을 배치하여 에너지가 흐르는 상태를 극명하게 대조.
- **글로우 레이어**: 파이프 하단에 은은한 발광 레이어를 추가하여 어두운 배경에서 빛이 번지는 시각적 디테일 확보.

#### 3) 현장 분위기 UI/UX (Industrial Site HUD)
- **라이팅 시스템**: 배경을 깊은 검정(`0x0a0a0a`)으로 설정하고 방사형 그라데이션을 적용하여 집중도 향상.
- **HUD 스타일 레이아웃**: 상단 UI 박스에 오렌지색 포인트 컬러와 상태 표시등(Status Dot)을 배치하여 산업용 제어판 느낌 강조.

#### 4) 애니메이션 최적화
- **반전 탄성 효과**: 회전 시 `back.out(1.2)` 이징을 적용하여 묵직한 기계 장치가 틱- 걸리며 돌아가는 물리적 피드백 제공.

---

## [2026-01-15] Industrial Pipe Illustration 디자인 전면 적용

### 1. 주요 작업 개요
- **목표**: "Industrial pipe connector detail illustration" 컨셉에 맞춘 고도화된 시각적 개편.
- **핵심 컨셉**: 공학 도면(Blueprint), 금속 질감, 정교한 기계 부품 디테일.

### 2. 상세 작업 내역

#### 1) 파이프 비주얼 고도화 (Advanced Pipe Rendering)
- **입체적 드로잉**: 단순 선에서 벗어나 그라데이션과 하이트라이트(`PIPE_HIGHLIGHT`)를 포함한 3D 느낌의 실린더 파이프 구현.
- **부품 디테일 추가**: 
    - **플랜지(Flange)**: 파이프 연결부마다 산업용 규격 느낌의 플랜지 요소 추가.
    - **볼트(Bolts)**: 플랜지에 고정용 볼트 디테일을 추가하여 기계적 완성도 향상.
    - **허브(Hub)**: 중앙 연결부에 볼트가 박힌 강화 소켓 디자인 적용.

#### 2) 활성화 상태 시각 효과 (Neon Fluid Glow)
- **네온 코어**: 파이프 내부 코어(`INNER_CORE_WIDTH`)를 통해 에너지가 흐르는 듯한 네온 효과 적용.
- **글로우(Glow)**: `PIXI.BLEND_MODES.ADD`를 활용하여 파이프 주변에 은은한 발광 효과를 추가, 활성화 상태를 직관적이고 미려하게 표현.

#### 3) 도면 스타일 환경 구축 (Engineering Environment)
- **배경 설계**: 베이지색 종이 질감 배경과 세밀한 그리드 라인(`dcd4b8`)을 통해 공학 도면 분위기 조성.
- **UI 리뉴얼**: 타이틀 및 상태창을 도면의 '주석(Annotation)' 박스 스타일로 변경하고 `JetBrains Mono` 폰트를 사용하여 전문적인 느낌 강화.

#### 4) 마커 및 인디케이터 최적화
- **변압기/전구**: 산업용 제어반(Control Panel) 및 인디케이터 램프 스타일로 마커 디자인 변경.
- **공유 경로**: 다중 회로 중첩 시 흰색 코어로 빛나는 로직 유지 및 비주얼 최적화.

---

## [2026-01-15] 회로 로직 무결성 확보 및 미관 정밀 정제

### 1. 주요 작업 개요
- **목표**: "연결되었으나 점등되지 않는" 논리적 오류 완전 해결 및 미관상 지저분한 연결부 제거.
- **주요 개선 항목**: 변압기/전구 연결성, 최상단 줄 배선 금지 규칙, 공유 경로 시각화 고도화.

### 2. 상세 작업 내역

#### 1) 변압기 및 전구 미관 정제 (Visual Polish)
- **변압기 설정**: 사방으로 뻗어있던 점(Connector ticks)들을 제거하고, 오직 아래 방향(`⚡↓`)으로만 전선이 연결되도록 고정하여 깔끔한 시작점 구현.
- **전구 설정**: 사방 수용 방식에서 실제 생성된 경로 방향으로만 연결구를 가지도록 동적 할당 로직 적용. 불필요한 연결부 노출을 차단하여 퍼즐의 완성도 향상.

#### 2) 최상단 줄(Row 0) 배선 금지 규칙 강화
- **배경**: 변압기 옆 칸에 의미 없는 배선이 생기거나 회전되는 문제 해결.
- **수정**: 그리드 초기화 단계(`initGrid`)에서 변압기가 위치한 중앙 칸을 제외한 모든 `y=0` 좌표의 타일을 물리적으로 배선 불가능한 빈 공간으로 강제 고정.

#### 3) 회로 탐색 로직(checkPath) 완전 재설계
- **BFS 기반 탐색**: 기존의 파편화된 로직을 버리고, 변압기에서 시작하여 모든 전구까지의 도달 가능성을 매 클릭 시 실시간으로 전수 조사하는 BFS(Breadth-First Search) 알고리즘 도입.
- **가지치기(Pruning) 최적화**: 전구까지 도달하지 못한 "막다른 길"은 절대 빛나지 않도록 정교하게 필터링하여 사용자에게 혼동을 주지 않는 시각적 피드백 제공.

#### 4) 전류 중첩 시각화 (Shared Path)
- **공유 경로 하이라이트**: 두 개 이상의 전구 회로가 겹치는 선로 구간을 **'흰색'** 코어로 빛나게 표현하여, 공통 전력 공급 구간임을 직관적으로 인지시킴.
- **색상 분리**: 분기점 이후부터는 각 전구의 고유 색상(Cyan, Magenta)으로 자연스럽게 전환되도록 데이터 아키텍처(Array of colors) 보강.

### 3. 기술적 특이사항
- **데이터 일관성**: `Pipe` 클래스 내 `activeColors` 배열의 초기화 및 상태 관리 실패를 전면 수정하여 실시간 업데이트의 신뢰성 확보.
- **수정 도구 안정성**: 복합적인 논리 구조 변경 시 발생하던 에이전트의 부분 수정 실패(Diff apply error)에 대응하여 `write_to_file` 기반의 전면 교체(Full Rewrite) 방식을 적용함으로써 코드 결함 방지.

---

## [2026-01-14] 전기 배선 퍼즐 MVP 고도화 및 시스템 안정화

### 1. 주요 작업 개요
- **프로젝트**: 전기 배선 퍼즐 (Electrical Wiring Puzzle)
- **목표**: PixiJS 기반의 10x10 그리드 배선 퍼즐 MVP 구현 및 사용자 피드백 반영
- **기술 스택**: HTML5, PixiJS v7, GSAP v3 (상태 관리 및 애니메이션)

### 2. 상세 작업 내역

#### 1) 초기 시스템 구축
- 10x10 그리드 시스템 설계 및 `Pipe`, `Grid` 클래스 기반 구조화.
- 외부 CDN 연결 불안정 문제 해결을 위해 `pixi.min.js`, `gsap.min.js` 로컬 라이브러리 도입.

#### 2) 배선 모델(Hub & Arms) 및 회전 로직
- **로직**: 중앙 허브를 중심으로 4방향(상, 하, 좌, 우) 암(Arm)의 활성 상태 관리.
- **애니메이션**: GSAP을 이용한 90도 회전 및 `back.out` 이징 적용으로 클릭 피드백 강화.
- **고정 타일**: 변압기(Start)와 전구(End) 타일은 클릭 시 회전하지 않도록 고정 처리.

#### 3) 퍼즐 생성 및 난이도 조절
- **경로 보장**: Random Walk 알고리즘을 사용하여 변압기에서 전구까지의 유효 경로를 최소 1개 이상 선행 생성(Solvability 확보).
- **빈 타일**: 맵의 밀도를 낮추기 위해 경로 외 타일의 50%를 빈 공간으로 처리하는 로직 적용.

#### 4) 다중 전구 및 회로 피드백 고도화 (핵심 업데이트)
- **다중 목표**: 
  - 변압기: 최상단 중앙 (4, 0) 고정, 단일 배선(아래방향) 적용.
  - 전구 1: 우측 하단 (9, 9) - 청록색(Cyan) 발광.
  - 전구 2: 좌측 하단 (0, 9) - 마젠타색(Magenta) 발광.
- **회로 연결 판정**: 
  - 단순 BFS 경로 탐색에서 **'전류 도달 교집합 탐색'**으로 로직 업그레이드.
  - 단순히 전원에 연결된 것만으로는 빛나지 않으며, **전구까지 회로가 형성된 배선만** 빛나도록 구현.
  - 중간에 끊긴 가지(Dead End)는 빛나지 않도록 처리하여 시각적 명확성 확보.

#### 5) UX/UI 기능 확장
- **화면 조작**: 마우스 휠(Wheel) 확대/축소(Zoom) 및 드래그(Drag) 화면 이동(Pan) 기능 구현.
- **상호작용 충돌 방지**: 화면 이동(Pan) 중에는 배선 회전(Click)이 무시되도록 트리거 보정 logic 적용.
- **반응형**: 브라우저 창 크기에 따라 캔버스 크기가 자동 조절되도록 설정.

### 3. 트러블슈팅 및 해결 과정
- **문제**: 코드 수정 시 일부 로직이 누락되거나 이전 버전이 유지되는 현상 발생.
- **원인**: 에이전트의 부분 수정(Diff-based edit) 도구가 복잡한 단일 파일 내 중복 패턴을 정확히 식별하지 못해 발생한 컨텍스트 불일치.
- **해결**: 핵심 로직 변경 시 파일 전체를 다시 쓰는(Rewrite) 방식을 도입하여 모든 변경 사항이 100% 반영되도록 강제함.

---
**작성자**: Antigravity (AI Coding Assistant)
