# 🧩 Match to Pipe - 퍼즐 디자인

**문서 목적**: 5단계 퍼즐의 세부 규칙 및 난이도 설계
**최종 업데이트**: 2026-01-15

---

## 📋 기본 메커니즘

### 현재 MVP 상태
- **그리드**: 11x11 타일
- **조작**: 파이프 타일 클릭 → 90도 회전
- **목표**: 변압기(⚡)에서 전구(💡)로 배선 연결
- **시각 피드백**:
  - 연결된 배선은 cyan(0x00FFFF) / magenta(0xFF00FF)
  - 두 색이 겹치면 흰색

### 사용 가능한 파이프 타입
- 직선 (ㅡ, ㅣ)
- L자 (ㄱ, ㄴ, ㄷ, ㄹ)
- T자 (ㅗ, ㅜ, ㅏ, ㅓ)
- 십자 (+)

---

## 🎯 5단계 난이도 설계

### 1단계: 튜토리얼
**목표**: 기본 조작 익히기 (기존 MVP 그대로)

**설정**:
- [x] 그리드 크기: **11x11**
- [x] 변압기: **1개** (상단 중앙)
- [x] 전구: **2개** (좌하단, 우하단)
- [x] 장애물 벽: **0개**
- [x] 고정 타일: **많음** (정답 경로 80% 고정)
- [x] 회전 가능 타일: **5개** (몇 개만 돌리면 됨)
- [x] 특수 요소: 없음

**난이도**: ⭐☆☆☆☆
**예상 플레이 타임**: 1~2분

**디자인 노트**:
- 거의 완성된 경로
- 실패 거의 불가능 (튜토리얼)

---

### 2단계: 기본 응용
**목표**: 전구 3개, 장애물 등장

**설정**:
- [x] 그리드 크기: **11x11**
- [x] 변압기: **1개** (상단 중앙)
- [x] 전구: **3개** (좌하단, 우하단, 중앙하단)
- [x] 장애물 벽: **3~5개** (경로 방해)
- [x] 고정 타일: **중간** (정답 경로 60% 고정)
- [x] 회전 가능 타일: **10개**
- [x] 특수 요소: 장애물 벽 (검은색 블록)

**난이도**: ⭐⭐☆☆☆
**예상 플레이 타임**: 2~3분

**디자인 노트**:
- 장애물로 인해 우회 경로 필요
- 경로 분기점 추가

---

### 3단계: 꽝 전구 등장
**목표**: 전구 4개 + 꽝 전구 1개 피하기

**설정**:
- [x] 그리드 크기: **11x11**
- [x] 변압기: **1개**
- [x] 전구 (정상): **4개**
- [x] 전구 (꽝): **1개** (빨간색 💀)
- [x] 장애물 벽: **7~10개** (복잡한 미로)
- [x] 고정 타일: **적음** (정답 경로 40% 고정)
- [x] 회전 가능 타일: **15개**
- [x] 특수 요소: 꽝 전구 (빨강 0xFF0000)

**꽝 전구 규칙**:
- [x] 꽝 전구 연결시 즉시 실패 → 해당 단계 재시도

**난이도**: ⭐⭐⭐☆☆
**예상 플레이 타임**: 3~5분

**디자인 노트**:
- 꽝 전구가 정답 경로 근처 (함정)
- 장애물로 인한 복잡한 경로

---

### 4단계: 복잡도 증가
**목표**: 전구 5개 + 고정 타일 증가

**설정**:
- [x] 그리드 크기: **12x12** (그리드 확장)
- [x] 변압기: **1개**
- [x] 전구: **5개**
- [x] 꽝 전구: **0개**
- [x] 장애물 벽: **12~15개** (복잡한 미로)
- [x] 고정 타일: **많음** (정답 경로 70% 고정, 하지만 어디가 정답인지 알기 어려움)
- [x] 회전 가능 타일: **20개**
- [x] 특수 요소: 그리드 확장

**난이도**: ⭐⭐⭐⭐☆
**예상 플레이 타임**: 5~7분

**디자인 노트**:
- 그리드 확장으로 전체 복잡도 증가
- 고정 타일이 많지만 데코이 역할
- 여러 분기점 중 선택

---

### 5단계: 최종 도전
**목표**: 최대 난이도 - 전구 5개 + 최소 고정

**설정**:
- [x] 그리드 크기: **13x13** (최대 확장)
- [x] 변압기: **1개**
- [x] 전구: **5개** (멀리 떨어진 위치)
- [x] 꽝 전구: **0개**
- [x] 장애물 벽: **20~25개** (복잡한 미로)
- [x] 고정 타일: **매우 적음** (정답 경로 30% 고정)
- [x] 회전 가능 타일: **30~35개**
- [x] 특수 요소: 그리드 최대 확장

**난이도**: ⭐⭐⭐⭐⭐
**예상 플레이 타임**: 7~10분

**디자인 노트**:
- 가장 넓고 복잡한 경로
- 회전 가능 타일이 많아 자유도 높음
- 여러 시행착오 필요
- 클리어 후 성취감 극대화

---

## 🤔 검토 필요한 메커니즘

### 추가 요소 고려사항

#### 1. 시간 제한
- [ ] 스테이지별 시간 제한?
- [ ] 전체 5단계 통합 시간?
- [x] **시간 제한 없음 (권장)** - 감성 게임이므로 여유롭게

#### 2. 힌트 시스템
- [ ] 정답 경로 살짝 보여주기?
- [ ] 회전 횟수 제한?
- [x] **무제한 회전 가능** - 자유롭게 탐색

#### 3. 실패 조건
- [x] **꽝 전구 연결시만 실패** (3단계에서만 등장)
- [ ] ~~시간 초과시~~
- [x] **단계별 무한 재시도 가능**
- [x] **한 판(5단계) 중 하나라도 실패시 야근** = 편지 못받음

#### 4. 추가 메커니즘
- [x] **장애물 벽** (핵심 난이도 요소)
- [x] **고정 타일 비율 조절** (난이도 조절)
- [ ] ~~전력 관리 시스템~~ (너무 복잡)
- [ ] ~~컬러 믹싱~~ (불필요)
- [x] **시간 기반 플로우 애니메이션 (선택)** - 클리어 후 연출만

**결정**: 단순하지만 효과적인 메커니즘 (장애물 + 고정타일)

---

## 🎨 시각적 요소

### 에셋 필요 목록
- [ ] 변압기 아이콘 (⚡)
- [ ] 정상 전구 아이콘 (💡)
- [ ] 꽝 전구 아이콘 (💡❌ 또는 빨간색?)
- [ ] 파이프 타일 (현재 있음)
- [ ] 고정 타일 표시 (자물쇠?)
- [ ] 배경 이미지

### 색상 팔레트
- 배선 활성화: cyan(0x00FFFF) / magenta(0xFF00FF)
- 꽝 전구: 빨강(0xFF0000)?
- 배경: 어두운 톤 (0x111111)

---

## 📝 결정 사항 요약

### ✅ 확정된 것들

**난이도 곡선**:
1. **튜토리얼**: 전구 2개, 장애물 없음, 거의 완성된 경로
2. **기본 응용**: 전구 3개, 장애물 벽 3~5개
3. **꽝 전구**: 전구 4개 + 꽝 1개, 장애물 벽 7~10개 (실패 메커니즘)
4. **복잡도 증가**: 전구 5개, 장애물 벽 12~15개, 그리드 12x12
5. **최종 도전**: 전구 5개, 장애물 벽 20~25개, 그리드 13x13, 회전 타일 최대

**난이도 조절 요소**:
- 전구 개수 증가 (2 → 3 → 4 → 5)
- 장애물 벽 증가 (미로 복잡도)
- 고정 타일 비율 변화 (많음 → 적음)
- 그리드 확장 (11 → 12 → 13)
- 꽝 전구는 3단계에만 1개 (과하게 사용 안 함)

**게임 규칙**:
- 시간 제한 없음 (캐주얼)
- 무제한 회전 가능
- 꽝 전구 연결시 즉시 실패 → 해당 단계만 재시도
- 5단계 중 하나라도 실패하면 야근 = 편지 못받음
- 5단계 모두 성공하면 정시퇴근 = 편지 조각 1개 획득

**시각 요소**:
- 배선 색: cyan / magenta
- 장애물 벽: 검은색 블록 (통과 불가)
- 꽝 전구: 빨강 0xFF0000
- 클리어 후 전기 흐르는 애니메이션 (선택)

---

## 🎯 구현 우선순위

### Phase 1: 기본 5단계 (필수)
1. **장애물 벽 시스템 구현** (검은 블록, 통과 불가)
2. 1단계 퍼즐 맵 생성
3. 2~5단계 퍼즐 맵 생성 (그리드 크기 변화 포함)
4. 꽝 전구 메커니즘 구현 (3단계에만)
5. 단계 전환 로직

### Phase 2: 실패/성공 처리 (필수)
1. 꽝 전구 연결 감지 → 단계 실패
2. 단계 재시도 시스템
3. 5단계 성공 → 편지 획득
4. 5단계 실패 → 야근 (편지 없음)

### Phase 3: 시각 폴리싱 (선택)
1. 전기 흐르는 애니메이션
2. 장애물 벽 시각 효과
3. 꽝 전구 경고 효과
4. 클리어 연출 강화

---

**다음 작업**: 기술적 구현 계획 수립
